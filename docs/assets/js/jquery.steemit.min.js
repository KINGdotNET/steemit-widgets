/**
 * jQuery Steemit Plugin
 * @author mkt <kontakt@markus-kottlaender.de>
 * @license MIT
 */
!function(e){e.fn.steemit=function(){var t=this,a={};return a.profile=function(i){function r(){steem.api.getAccounts([l.user],function(e,i){if(!e&&i.length){var i=i[0],r=JSON.parse(i.json_metadata).profile;steem.api.getFollowCount(l.user,function(e,n){var o=a.getTemplate(l.template).replace(/\${USER}/gi,i.name).replace(/\${NAME}/gi,r.name).replace(/\${LOCATION}/gi,r.location).replace(/\${WEBSITE}/gi,r.website).replace(/\${IMAGE}/gi,r.profile_image).replace(/\${REPUTATION}/gi,a.calculateReputation(i.reputation,l.reputationPrecision)).replace(/\${VOTINGPOWER}/gi,a.calculateVotingPower(i.voting_power,i.last_vote_time,l.votingPowerPrecision)).replace(/\${FOLLOWERS}/gi,n.follower_count).replace(/\${FOLLOWING}/gi,n.following_count).replace(/\${POSTCOUNT}/gi,i.post_count).replace(/\${ABOUT}/gi,r.about);t.html(o)})}else t.html("Error: API not responding!")})}var l=e.extend({user:"mkt",template:'<img width="100" src="${IMAGE}" /><br><a href="https://steemit.com/@${USER}">@${USER}</a>',reputationPrecision:0,votingPowerPrecision:2,updateInterval:10},i);r(),l.updateInterval&&setInterval(r,1e3*l.updateInterval)},a.blog=function(i){function r(){steem.api.getDiscussionsByBlog({tag:l.user,limit:l.limit},function(e,i){if(!e&&i.length){for(var r="",n=0;n<i.length;n++){var o=JSON.parse(i[n].json_metadata),c=a.getTemplate(l.template).replace(/\${URL}/gi,"https://steemit.com"+i[n].url).replace(/\${TITLE}/gi,i[n].title).replace(/\${AUTHOR}/gi,i[n].author).replace(/\${RESTEEMED}/gi,i[n].author!=l.user?l.resteemedIndicator:"").replace(/\${RESTEEMEDBY}/gi,i[n].first_reblogged_by?"resteemed by "+i[n].first_reblogged_by:"").replace(/\${DATE}/gi,l.dateCallback(new Date(i[n].created))).replace(/\${IMAGE}/gi,o.image?o.image[0]:l.defaultImage).replace(/\${PAYOUT}/gi,a.getPayout(i[n]).toFixed(l.payoutPrecision)).replace(/\${COMMENTS}/gi,i[n].children).replace(/\${UPVOTES}/gi,i[n].net_votes).replace(/\${CATEGORY}/gi,i[n].category);r+=c}t.html(r)}else t.html("Error: API not responding!")})}var l=e.extend({user:"mkt",limit:10,template:'<div><a href="${URL}">${TITLE}</a>${RESTEEMED}<br>${Payout}, ${UPVOTES} Upvotes, ${COMMENTS} Comments</div>',defaultImage:"https://steemitimages.com/DQmXYX9hqSNcikTK8ARb61BPnTk4CKMhaiqr22iCKD8CKsp/steemit-logo.png",resteemedIndicator:" (resteemed) ",payoutPrecision:2,updateInterval:10,dateCallback:function(e){return e}},i);r(),l.updateInterval&&setInterval(r,1e3*l.updateInterval)},a.feed=function(i){function r(){steem.api.getDiscussionsByFeed({tag:l.user,limit:l.limit},function(e,i){if(!e&&i.length){for(var r="",n=0;n<i.length;n++){var o=JSON.parse(i[n].json_metadata),c=a.getTemplate(l.template).replace(/\${URL}/gi,"https://steemit.com"+i[n].url).replace(/\${TITLE}/gi,i[n].title).replace(/\${AUTHOR}/gi,i[n].author).replace(/\${RESTEEMED}/gi,i[n].first_reblogged_by?l.resteemedIndicator:"").replace(/\${RESTEEMEDBY}/gi,i[n].first_reblogged_by?"resteemed by "+i[n].first_reblogged_by:"").replace(/\${DATE}/gi,l.dateCallback(new Date(i[n].created))).replace(/\${IMAGE}/gi,o.image?o.image[0]:l.defaultImage).replace(/\${PAYOUT}/gi,a.getPayout(i[n]).toFixed(l.payoutPrecision)).replace(/\${COMMENTS}/gi,i[n].children).replace(/\${UPVOTES}/gi,i[n].net_votes).replace(/\${CATEGORY}/gi,i[n].category);r+=c}t.html(r)}else t.html("Error: API not responding!")})}var l=e.extend({user:"mkt",limit:10,template:'<div><a href="${URL}">${TITLE}</a>${RESTEEMED}<br>${Payout}, ${UPVOTES} Upvotes, ${COMMENTS} Comments</div>',defaultImage:"https://steemitimages.com/DQmXYX9hqSNcikTK8ARb61BPnTk4CKMhaiqr22iCKD8CKsp/steemit-logo.png",resteemedIndicator:" (resteemed) ",payoutPrecision:2,updateInterval:10,dateCallback:function(e){return e}},i);r(),l.updateInterval&&setInterval(r,1e3*l.updateInterval)},a.new=function(i){function r(){steem.api.getDiscussionsByCreated({tag:l.tag,limit:l.limit},function(e,i){if(!e&&i.length){for(var r="",n=0;n<i.length;n++){var o=JSON.parse(i[n].json_metadata),c=a.getTemplate(l.template).replace(/\${URL}/gi,"https://steemit.com"+i[n].url).replace(/\${TITLE}/gi,i[n].title).replace(/\${AUTHOR}/gi,i[n].author).replace(/\${DATE}/gi,l.dateCallback(new Date(i[n].created))).replace(/\${IMAGE}/gi,o.image?o.image[0]:l.defaultImage).replace(/\${PAYOUT}/gi,a.getPayout(i[n]).toFixed(l.payoutPrecision)).replace(/\${COMMENTS}/gi,i[n].children).replace(/\${UPVOTES}/gi,i[n].net_votes).replace(/\${CATEGORY}/gi,i[n].category);r+=c}t.html(r)}else t.html("Error: API not responding!")})}var l=e.extend({tag:null,limit:10,template:'<div><a href="${URL}">${TITLE}</a><br>${Payout}, ${UPVOTES} Upvotes, ${COMMENTS} Comments</div>',defaultImage:"https://steemitimages.com/DQmXYX9hqSNcikTK8ARb61BPnTk4CKMhaiqr22iCKD8CKsp/steemit-logo.png",payoutPrecision:2,updateInterval:10,dateCallback:function(e){return e}},i);r(),l.updateInterval&&setInterval(r,1e3*l.updateInterval)},a.hot=function(i){function r(){steem.api.getDiscussionsByHot({tag:l.tag,limit:l.limit},function(e,i){if(!e&&i.length){for(var r="",n=0;n<i.length;n++){var o=JSON.parse(i[n].json_metadata),c=a.getTemplate(l.template).replace(/\${URL}/gi,"https://steemit.com"+i[n].url).replace(/\${TITLE}/gi,i[n].title).replace(/\${AUTHOR}/gi,i[n].author).replace(/\${DATE}/gi,l.dateCallback(new Date(i[n].created))).replace(/\${IMAGE}/gi,o.image?o.image[0]:l.defaultImage).replace(/\${PAYOUT}/gi,a.getPayout(i[n]).toFixed(l.payoutPrecision)).replace(/\${COMMENTS}/gi,i[n].children).replace(/\${UPVOTES}/gi,i[n].net_votes).replace(/\${CATEGORY}/gi,i[n].category);r+=c}t.html(r)}else t.html("Error: API not responding!")})}var l=e.extend({tag:null,limit:10,template:'<div><a href="${URL}">${TITLE}</a><br>${Payout}, ${UPVOTES} Upvotes, ${COMMENTS} Comments</div>',defaultImage:"https://steemitimages.com/DQmXYX9hqSNcikTK8ARb61BPnTk4CKMhaiqr22iCKD8CKsp/steemit-logo.png",payoutPrecision:2,updateInterval:10,dateCallback:function(e){return e}},i);r(),l.updateInterval&&setInterval(r,1e3*l.updateInterval)},a.trending=function(i){function r(){steem.api.getDiscussionsByTrending({tag:l.tag,limit:l.limit},function(e,i){if(!e&&i.length){for(var r="",n=0;n<i.length;n++){var o=JSON.parse(i[n].json_metadata),c=a.getTemplate(l.template).replace(/\${URL}/gi,"https://steemit.com"+i[n].url).replace(/\${TITLE}/gi,i[n].title).replace(/\${AUTHOR}/gi,i[n].author).replace(/\${DATE}/gi,l.dateCallback(new Date(i[n].created))).replace(/\${IMAGE}/gi,o.image?o.image[0]:l.defaultImage).replace(/\${PAYOUT}/gi,a.getPayout(i[n]).toFixed(l.payoutPrecision)).replace(/\${COMMENTS}/gi,i[n].children).replace(/\${UPVOTES}/gi,i[n].net_votes).replace(/\${CATEGORY}/gi,i[n].category);r+=c}t.html(r)}else t.html("Error: API not responding!")})}var l=e.extend({tag:null,limit:10,template:'<div><a href="${URL}">${TITLE}</a><br>${Payout}, ${UPVOTES} Upvotes, ${COMMENTS} Comments</div>',defaultImage:"https://steemitimages.com/DQmXYX9hqSNcikTK8ARb61BPnTk4CKMhaiqr22iCKD8CKsp/steemit-logo.png",payoutPrecision:2,updateInterval:10,dateCallback:function(e){return e}},i);r(),l.updateInterval&&setInterval(r,1e3*l.updateInterval)},a.getTemplate=function(e){var t=document.getElementById(e);return t?t.innerHTML:e},a.getPayout=function(e){if("1970-01-01T00:00:00"==e.last_payout){var t=e.pending_payout_value.replace(" SBD","");return parseFloat(t)}var a=e.total_payout_value.replace(" SBD",""),i=e.curator_payout_value.replace(" SBD","");return parseFloat(a)+parseFloat(i)},a.calculateReputation=function(e,t){return(0>e?"-":"")+(9*(Math.log10(Math.abs(e))-9)+25).toFixed(t)},a.calculateVotingPower=function(e,t,a){var i=(new Date-new Date(t+"Z"))/1e3;return e+=1e4*i/432e3,Math.min(e/100,100).toFixed(a)},a}}(jQuery);
